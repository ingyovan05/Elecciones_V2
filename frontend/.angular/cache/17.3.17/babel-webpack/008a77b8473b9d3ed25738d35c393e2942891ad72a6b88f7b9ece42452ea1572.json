{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./auth.service\";\nexport let InactivityService = /*#__PURE__*/(() => {\n  class InactivityService {\n    constructor(zone, auth) {\n      this.zone = zone;\n      this.auth = auth;\n      this.limit = 60 * 1000; // 1 minute of inactivity\n      this.listeners = [];\n      this.zone.runOutsideAngular(() => {\n        const windowEvents = ['click', 'keydown', 'mousemove', 'mousedown', 'touchstart', 'touchmove', 'pointerdown', 'pointermove', 'wheel', 'scroll'];\n        windowEvents.forEach(event => {\n          const handler = () => this.resetTimer();\n          window.addEventListener(event, handler, {\n            passive: true\n          });\n          this.listeners.push(() => window.removeEventListener(event, handler));\n        });\n        const visibilityHandler = () => {\n          if (document.visibilityState === 'visible') {\n            this.resetTimer();\n          }\n        };\n        document.addEventListener('visibilitychange', visibilityHandler);\n        this.listeners.push(() => document.removeEventListener('visibilitychange', visibilityHandler));\n      });\n    }\n    start() {\n      this.resetTimer();\n    }\n    stop() {\n      if (this.timeoutId) {\n        clearTimeout(this.timeoutId);\n        this.timeoutId = undefined;\n      }\n    }\n    resetTimer() {\n      if (!this.auth.token) return;\n      if (this.timeoutId) clearTimeout(this.timeoutId);\n      this.timeoutId = window.setTimeout(() => {\n        this.zone.run(() => this.auth.logout('Sesión cerrada por inactividad'));\n      }, this.limit);\n    }\n    ngOnDestroy() {\n      this.listeners.forEach(remove => remove());\n      this.stop();\n    }\n    static {\n      this.ɵfac = function InactivityService_Factory(t) {\n        return new (t || InactivityService)(i0.ɵɵinject(i0.NgZone), i0.ɵɵinject(i1.AuthService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: InactivityService,\n        factory: InactivityService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return InactivityService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}